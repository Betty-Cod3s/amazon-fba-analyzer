function analyzeData() {
            const minUnits = parseInt(document.getElementById('minUnits').value) || 7;
            const analysisPeriod = parseInt(document.getElementById('analysisPeriod').value) || 30;
            const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;

            showStatus('loading', 'Analyzing your data...');

            setTimeout(() => {
                try {
                    // Step 1: Group inventory by ASIN to check for mixed fulfillment
                    const asinGroups = {};
                    inventoryData.forEach(item => {
                        // Try multiple possible ASIN column names
                        const asin = item.asin1 || item.asin || item.ASIN || item['product-id'] || item['product-id-type'];
                        
                        // Skip if no ASIN found
                        if (!asin || asin === '') return;
                        
                        // Try multiple possible fulfillment column names and normalize
                        let fulfillment = item['fulfillment-channel'] || 
                                        item['Fulfillment Channel'] || 
                                        item.fulfillment || 
                                        item.Fulfillment || 
                                        '';
                        
                        fulfillment = fulfillment.toString().toUpperCase().trim();
                        
                        if (!asinGroups[asin]) {
                            asinGroups[asin] = {
                                asin: asin,
                                fulfillmentMethods: new Set(),
                                items: [],
                                skus: []
                            };
                        }
                        
                        // Add the fulfillment method to the set
                        if (fulfillment) {
                            asinGroups[asin].fulfillmentMethods.add(fulfillment);
                        }
                        
                        // Track SKUs for debugging
                        const sku = item['seller-sku'] || item.sku || item.SKU || 'unknown';
                        asinGroups[asin].skus.push(sku);
                        asinGroups[asin].items.push(item);
                    });

                    console.log('=== DEBUGGING ASIN GROUPING ===');
                    console.log(`Total ASINs found: ${Object.keys(asinGroups).length}`);
                    
                    // Debug: Show first 5 ASINs with their fulfillment methods
                    Object.values(asinGroups).slice(0, 5).forEach(group => {
                        console.log(`ASIN ${group.asin}:`, {
                            methods: Array.from(group.fulfillmentMethods),
                            skuCount: group.skus.length,
                            skus: group.skus
                        });
                    });

                    // Step 2: Filter for FBM-only ASINs (no mixed fulfillment)
                    const fbmOnlyAsins = Object.values(asinGroups).filter(group => {
                        const methods = Array.from(group.fulfillmentMethods);
                        
                        // Check for FBA indicators (more comprehensive)
                        const hasFBA = methods.some(method => 
                            method.includes('AMAZON') || 
                            method === 'AFN' ||
                            method === 'FBA'
                        );
                        
                        // Check for FBM indicators
                        const hasFBM = methods.some(method => 
                            method === 'DEFAULT' || 
                            method === 'MERCHANT' ||
                            method === 'MFN' ||
                            method.includes('SELLER')
                        );
                        
                        // Only return ASINs that are ONLY FBM (no FBA at all)
                        return hasFBM && !hasFBA;
                    });

                    console.log(`FBM-only ASINs (no FBA variants): ${fbmOnlyAsins.length}`);
                    console.log('Sample FBM-only ASINs:', fbmOnlyAsins.slice(0, 3).map(g => ({
                        asin: g.asin,
                        methods: Array.from(g.fulfillmentMethods)
                    })));

                    // Store debug info
                    debugInfo = `INVENTORY ANALYSIS
====================================
Total ASINs found: ${Object.keys(asinGroups).length}
FBM-only ASINs: ${fbmOnlyAsins.length}

SAMPLE ASIN BREAKDOWN (first 10):
`;
                    
                    Object.values(asinGroups).slice(0, 10).forEach(group => {
                        const methods = Array.from(group.fulfillmentMethods);
                        const hasFBA = methods.some(m => m.includes('AMAZON') || m === 'AFN' || m === 'FBA');
                        const hasFBM = methods.some(m => m === 'DEFAULT' || m === 'MERCHANT' || m === 'MFN');
                        
                        debugInfo += `\nASIN: ${group.asin}
  SKUs: ${group.skus.join(', ')}
  Fulfillment Methods: ${methods.join(', ')}
  Has FBA: ${hasFBA ? 'YES ✓' : 'NO'}
  Has FBM: ${hasFBM ? 'YES' : 'NO'}
  Status: ${hasFBM && !hasFBA ? '✓ FBM-ONLY (ELIGIBLE)' : hasFBA ? '✗ HAS FBA (SKIP)' : '? UNKNOWN'}
`;
                    });
